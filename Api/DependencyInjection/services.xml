<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>

        <service class="Shopware\Api\Entity\Dbal\EntityDefinitionQueryHelper" id="Shopware\Api\Entity\Dbal\EntityDefinitionQueryHelper" >
            <argument type="service" id="Shopware\Api\Entity\Dbal\FieldResolver\FieldResolverRegistry"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\FieldAccessorBuilderRegistry"/>
        </service>

        <service class="Shopware\Api\Entity\Dbal\EntityHydrator" id="Shopware\Api\Entity\Dbal\EntityHydrator">
            <argument type="service" id="serializer"/>
        </service>

        <service class="Shopware\Api\Entity\Search\Term\Tokenizer" id="Shopware\Api\Entity\Search\Term\Tokenizer"/>

        <service class="Shopware\Api\Entity\Search\Term\StopWordFilter" id="Shopware\Api\Entity\Search\Term\StopWordFilter"/>

        <service class="Shopware\Api\Entity\Search\Term\SearchTermInterpreter" id="Shopware\Api\Entity\Search\Term\SearchTermInterpreter" public="true">
            <argument id="Shopware\Api\Entity\Search\Term\Tokenizer" type="service"/>
        </service>

        <service class="Shopware\Api\Entity\Search\Term\EntityScoreQueryBuilder" id="Shopware\Api\Entity\Search\Term\EntityScoreQueryBuilder" public="true"/>

        <service class="Shopware\Api\Entity\Search\SearchCriteriaBuilder" id="Shopware\Api\Entity\Search\SearchCriteriaBuilder">
            <argument id="Shopware\Api\Entity\Search\Term\SearchTermInterpreter" type="service"/>
            <argument id="Shopware\Api\Entity\Search\Term\EntityScoreQueryBuilder" type="service"/>
        </service>

        <service class="Shopware\Api\Entity\ExtensionRegistry" id="Shopware\Api\Entity\ExtensionRegistry" public="true">
            <argument type="tagged" tag="shopware.entity.extension" />
        </service>

        <service class="Shopware\Api\Entity\DefinitionRegistry" id="Shopware\Api\Entity\DefinitionRegistry">
            <argument type="collection" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\EntityReader" id="Shopware\Api\Entity\Dbal\EntityReader">
            <argument id="Doctrine\DBAL\Connection" type="service"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntitySearcher"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntityHydrator"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntityDefinitionQueryHelper"/>
        </service>

        <service class="Shopware\Api\Entity\Dbal\EntityAggregator" id="Shopware\Api\Entity\Dbal\EntityAggregator">
            <argument id="Doctrine\DBAL\Connection" type="service"/>
            <argument id="Shopware\Api\Entity\Dbal\EntityReader" type="service"/>
            <tag name="shopware.traceable" label="entity.aggregator" />
            <argument type="service" id="Shopware\Api\Entity\Search\Parser\SqlQueryParser"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntityDefinitionQueryHelper"/>
        </service>

        <service class="Shopware\Api\Entity\Dbal\EntitySearcher" id="Shopware\Api\Entity\Dbal\EntitySearcher" >
            <argument id="Doctrine\DBAL\Connection" type="service"/>
            <argument type="service" id="Shopware\Api\Entity\Search\Parser\SqlQueryParser"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntityDefinitionQueryHelper"/>
        </service>

        <service class="Shopware\Api\Entity\Write\EntityWriter" id="Shopware\Api\Entity\Write\EntityWriter" public="true">
            <argument type="service" id="Shopware\Api\Entity\Write\WriteCommandExtractor"/>
            <argument type="service" id="Shopware\Api\Entity\Write\FieldAware\DefaultExtender"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntityForeignKeyResolver"/>
            <argument id="Shopware\Api\Entity\Dbal\EntityWriteGateway" type="service"/>
            <tag name="shopware.traceable" label="entity.writer" />
        </service>

        <service class="Shopware\Api\Entity\Write\WriteCommandExtractor" id="Shopware\Api\Entity\Write\WriteCommandExtractor">
            <argument id="Shopware\Api\Entity\Dbal\EntityWriteGateway" type="service"/>
        </service>

        <service class="Shopware\Api\Entity\Dbal\EntityWriteGateway" id="Shopware\Api\Entity\Dbal\EntityWriteGateway">
            <argument id="Doctrine\DBAL\Connection" type="service"/>
            <tag name="shopware.traceable" label="entity.write-gateway" />
        </service>

        <service id="Shopware\Api\Entity\Write\Validation\ConstraintBuilder" class="Shopware\Api\Entity\Write\Validation\ConstraintBuilder"/>

        <service class="Shopware\Api\Entity\Write\FieldAware\DefaultExtender" id="Shopware\Api\Entity\Write\FieldAware\DefaultExtender">
            <argument id="validator" type="service"/>
            <argument id="Shopware\Api\Entity\Write\Validation\ConstraintBuilder" type="service"/>
            <argument id="Shopware\Api\Entity\Write\IdGenerator\GeneratorRegistry" type="service"/>
            <argument id="Shopware\Api\Entity\Write\Filter\FilterRegistry" type="service"/>
            <argument id="Shopware\Api\Entity\Write\ValueTransformer\ValueTransformerRegistry" type="service"/>
        </service>

        <service class="Shopware\Api\Entity\Search\Parser\SqlQueryParser" id="Shopware\Api\Entity\Search\Parser\SqlQueryParser">
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntityDefinitionQueryHelper"/>
        </service>

        <!-- Value transformer -->
        <service class="Shopware\Api\Entity\Write\ValueTransformer\ValueTransformerRegistry" id="Shopware\Api\Entity\Write\ValueTransformer\ValueTransformerRegistry">
            <argument type="tagged" tag="shopware.api.entity.write.value_transformer" />
        </service>

        <service class="Shopware\Api\Entity\Write\ValueTransformer\ValueTransformerDate" id="Shopware\Api\Entity\Write\ValueTransformer\ValueTransformerDate">
            <tag name="shopware.api.entity.write.value_transformer"/>
        </service>

        <service class="Shopware\Api\Entity\Write\ValueTransformer\ValueTransformerBoolean" id="Shopware\Api\Entity\Write\ValueTransformer\ValueTransformerBoolean">
            <tag name="shopware.api.entity.write.value_transformer"/>
        </service>

        <!-- Filter -->
        <service class="Shopware\Api\Entity\Write\Filter\FilterRegistry" id="Shopware\Api\Entity\Write\Filter\FilterRegistry">
            <argument type="tagged" tag="shopware.api.entity.write.filter" />
        </service>

        <service class="Shopware\Api\Entity\Write\Filter\HtmlFilter" id="Shopware\Api\Entity\Write\Filter\HtmlFilter">
            <tag name="shopware.api.entity.write.filter"/>
        </service>

        <!-- ID GENERATOR -->
        <service class="Shopware\Api\Entity\Write\IdGenerator\GeneratorRegistry" id="Shopware\Api\Entity\Write\IdGenerator\GeneratorRegistry">
            <argument type="tagged" tag="shopware.api.entity.write.id_generator" />
        </service>


        <service class="Shopware\Api\Entity\Write\IdGenerator\RamseyGenerator" id="Shopware\Api\Entity\Write\IdGenerator\RamseyGenerator">
            <tag name="shopware.api.entity.write.id_generator"/>
        </service>

        <service class="Shopware\Api\Entity\Dbal\EntityForeignKeyResolver" id="Shopware\Api\Entity\Dbal\EntityForeignKeyResolver">
            <argument id="Doctrine\DBAL\Connection" type="service"/>
            <argument type="service" id="Shopware\Api\Entity\Dbal\EntityDefinitionQueryHelper"/>
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldResolver\FieldResolverRegistry" id="Shopware\Api\Entity\Dbal\FieldResolver\FieldResolverRegistry">
            <argument type="tagged" tag="shopware.entity.field_resolver" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldResolver\ManyToOneAssociationFieldResolver" id="Shopware\Api\Entity\Dbal\FieldResolver\ManyToOneAssociationFieldResolver">
            <tag name="shopware.entity.field_resolver" priority="-50" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldResolver\OneToManyAssociationFieldResolver" id="Shopware\Api\Entity\Dbal\FieldResolver\OneToManyAssociationFieldResolver">
            <tag name="shopware.entity.field_resolver" priority="-50" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldResolver\ManyToManyAssociationFieldResolver" id="Shopware\Api\Entity\Dbal\FieldResolver\ManyToManyAssociationFieldResolver">
            <tag name="shopware.entity.field_resolver" priority="-50" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldResolver\TranslationFieldResolver" id="Shopware\Api\Entity\Dbal\FieldResolver\TranslationFieldResolver">
            <tag name="shopware.entity.field_resolver"  priority="-50" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldResolver\ProductCoverFieldResolver" id="Shopware\Api\Entity\Dbal\FieldResolver\ProductCoverFieldResolver">
            <tag name="shopware.entity.field_resolver" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\FieldAccessorBuilderRegistry" id="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\FieldAccessorBuilderRegistry">
            <argument type="tagged" tag="shopware.entity.field_accessor_builder" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\ContextPriceFieldAccessorBuilder" id="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\ContextPriceFieldAccessorBuilder">
            <tag name="shopware.entity.field_accessor_builder" priority="-50" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\PriceFieldAccessorBuilder" id="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\PriceFieldAccessorBuilder">
            <tag name="shopware.entity.field_accessor_builder" priority="-100" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\JsonObjectFieldAccessorBuilder" id="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\JsonObjectFieldAccessorBuilder">
            <tag name="shopware.entity.field_accessor_builder" priority="-150" />
        </service>

        <service class="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\StandardFieldAccessorBuilder" id="Shopware\Api\Entity\Dbal\FieldAccessorBuilder\StandardFieldAccessorBuilder">
            <tag name="shopware.entity.field_accessor_builder" priority="-200" />
        </service>
    </services>
</container>
